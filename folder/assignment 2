# Jan 21 - assignment 2 mouse tutorial 

# turn on UBC VPN and connect to server
# log into ssh root@<IP address>


# locate data folder and make a new folder called mouse_tutorial_1

(qiime2-2023.7) root@118f121b24bd:~# cd /
(qiime2-2023.7) root@118f121b24bd:/# cd data
(qiime2-2023.7) root@118f121b24bd:/data# mkdir mouse_tutorial_1


# locate metadata.tsv file from mnt (use cd and ls)
#/mnt/datasets/project_1/mouse_tutorial

(qiime2-2023.7) root@118f121b24bd:/mnt/datasets/project_1/mouse_tutorial# ls
demultiplexed_seqs  manifest.tsv  metadata.tsv


# import Parkinson's Mouse tutorial dataset into mouse_tutorial_1 folder
# do not change the type and input-format 

(qiime2-2023.7) root@e28033ce5358:/data/mouse_tutorial_1# qiime tools import \
  --type "SampleData[SequencesWithQuality]" \
  --input-format SingleEndFastqManifestPhred33V2 \
  --input-path /mnt/datasets/project_1/mouse_tutorial/manifest.tsv \
  --output-path /data/mouse_tutorial_1/demux_seqs.qza

# convert qza file into qzv for visualization of demultiplexed samples

(qiime2-2023.7) root@e28033ce5358:/data/mouse_tutorial_1# qiime demux summarize \
  --i-data demux_seqs.qza \
  --o-visualization demux.qzv

# open a new window in terminal
# import the visualized demux file to a new folder in local computer called Mouse_Tutorial_
# make sure to have a space and period to execute command

Olivias-MacBook-Air:~ locoferrero$ cd Desktop
Olivias-MacBook-Air:Desktop locoferrero$ mkdir Mouse_Tutorial_
Olivias-MacBook-Air:Desktop locoferrero$ cd Mouse_Tutorial_
Olivias-MacBook-Air:Mouse_Tutorial_ locoferrero$ scp root@10.19.139.126:/data/mouse_tutorial_1/demux.qzv .


# analyze data in demux.qzv by dragging file into https://view.qiime2.org/ 



# back to the other window
# denoising and clustering the data (demux.qza)
# trim at 150 because median quality score is over 30 = high quality
# determine ASVs with DADA2

(qiime2-2023.7) root@e28033ce5358:/data/mouse_tutorial_1# ls
demux_seqs.qza	demux_seqs.qzv
(qiime2-2023.7) root@e28033ce5358:/data/mouse_tutorial_1# 
qiime dada2 denoise-single \
  --i-demultiplexed-seqs demux_seqs.qza \
  --p-trim-left 0 \
  --p-trunc-len 150 \
  --o-representative-sequences rep-seqs.qza \
  --o-table table.qza \
  --o-denoising-stats stats.qza
Saved FeatureTable[Frequency] to: table.qza
Saved FeatureData[Sequence] to: rep-seqs.qza
Saved SampleData[DADA2Stats] to: stats.qza


# converting qza files into qzv files for visualization (table and rep-seqs)
# wonâ€™t be working with the stats file 

(qiime2-2023.7) root@e28033ce5358:/data/mouse_tutorial_1# qiime feature-table summarize \
  --i-table table.qza \
  --o-visualization table.qzv \
  --m-sample-metadata-file /mnt/datasets/project_1/mouse_tutorial/metadata.tsv
Saved Visualization to: table.qzv
(qiime2-2023.7) root@e28033ce5358:/data/mouse_tutorial_1# qiime feature-table tabulate-seqs \
  --i-data rep-seqs.qza \
  --o-visualization rep-seqs.qzv
Saved Visualization to: rep-seqs.qzv


# import table.qzv and rep-sets.qzv into local computer Mouse_Tutorial_1 folder
# make sure to have a space and period to execute command

Olivias-MacBook-Air:Desktop locoferrero$ cd Mouse_Tutorial_
Olivias-MacBook-Air:Mouse_Tutorial_ locoferrero$ scp root@10.19.139.126:/data/mouse_tutorial_1/table.qzv .
Olivias-MacBook-Air:Mouse_Tutorial_ locoferrero$ scp root@10.19.139.126:/data/mouse_tutorial_1/rep-seqs.qzv .


# analyze data in table.qzv and rep-seqs.qzv by dragging file into https://view.qiime2.org/ 








