# P07 - Aim 2: Examine microbial taxa and diversity on the chosen variable, Age, that significantly correlate to bacterial composition

## March 3rd, 2024

## Purpose:
To perform relative abundance plot, alpha and beta diversity metrics on the mouse familial dysautonomia dataset to determine the microbial dynamics across mouse age.

## Material: 
1. R & Rstudio
2. FD_rare_only_separate.Rdata (phylosesq object)

## Method 
### relative abundance plot:
1. Import libraries: phyloseq, ggplot2, dplyr, reshape2, and tibble
2. Subset the phyloessq object by metadata categories -> FD_phyloseq_subset
3. Create a dataframe for the phyloseq subset
4. Convert absolute ASV reads into relative abundance for each sample in the otu table, and melt the dataframe 
5. Combine the tax and otu table by the ASV column
6. Subset the sample data with sample name and age only, then combine it with the combined tax and otu table by ASV column
7. Use ggplot to plot the relative abundance plot (x = sample name, y = relative abundance, color = phylum, stratified by age)

### Alpha diversity (Chao1, Shannon):
1. In FD_phyloseq_subset, transform sample counts to integer
2. Melt the metric dataset
3. Plot ggplot (x = age, y = metric)

### Beta diversity (Bray-Curtis, Jaccard, unweighted and weighted Unifrac):
1. Import libraries: phyloseq, ggplot2, dplyr, reshape2, vegan, and tibble
2. Subset the phyloessq object by metadata categories -> FD_phyloseq_subset
3. Factor the sample dataset to ensure the order of age
4. Create ordination for metric (parameter = PCoA, na.rm = T)
5. Plot the metric ordination (color = age)
6. Perform Permanova on each metric (dist.metric ~ Age,data=data)

## Output files:
### Alpha diversity
1. Results stacked bar plot and boxplots
### Beta diversity
2. Results PCoA plots
3. Permanova stats table

## Results: 

### Beta diveristy
Result PCoA Plot: 
![Aim2.bray.age](https://github.com/oliviakwon/MICB475_Team6/blob/c6aea439aca1fbbf540f32094f2e4be3c6cf7518)
